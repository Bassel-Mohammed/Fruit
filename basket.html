---
title: سلة المشتريات
---

<!DOCTYPE html>
<html lang="ar" dir="ltr">
{% include head.html %}

<body class="product-page">

 {% include navbar.html %}

<div class="container my-5 text-right">
  <h2>🛒 سلة المشتريات</h2>

  <!-- Customer info -->
  <div class="mb-4">
    <div class="form-group">
      <label for="customer-name">الاسم:</label>
      <input type="text" id="customer-name" class="form-control" placeholder="ادخل اسمك">
    </div>
    <div class="form-group">
      <label for="customer-location">العنوان / الموقع:</label>
      <input type="text" id="customer-location" class="form-control" placeholder="ادخل عنوانك">
    </div>
  </div>

  <div id="basket-items"></div>
  <h4 id="basket-total" class="mt-3"></h4>
  <button id="checkout-btn" class="btn btn-success mt-3">شراء الآن</button>
</div>

{% include footer.html %}
{% include scripts.html %}

<script>
  // Base URL for GitHub Pages
  const BASE_URL = "{{ site.baseurl }}"; // becomes "/Fruit"

  function renderBasket() {
    let basket = JSON.parse(localStorage.getItem("basket")) || [];
    let basketDiv = document.getElementById("basket-items");
    let totalDiv = document.getElementById("basket-total");
    basketDiv.innerHTML = "";

    if (basket.length === 0) {
      basketDiv.innerHTML = "<p>السلة فارغة</p>";
      totalDiv.innerHTML = "";
      return;
    }

    let total = 0;
    basket.forEach((item, index) => {
      // Fix image path dynamically
      let imagePath = item.image.startsWith("http") ? item.image : BASE_URL + item.image;
      total += item.price * item.qty;

      basketDiv.innerHTML += `
        <div class="card mb-3 p-3">
          <div class="row align-items-center">
            <div class="col-md-2">
              <img src="${imagePath}" alt="${item.title}" class="img-fluid rounded">
            </div>
            <div class="col-md-6 basket-product-description">
              <h5>${item.title}</h5>
              <p>السعر: $${item.price.toFixed(2)}</p>
              <p>الكمية: ${item.qty}</p>
            </div>
            <div class="col-md-4 text-left">
              <button class="btn btn-danger remove-item" data-index="${index}">إزالة</button>
            </div>
          </div>
        </div>
      `;
    });

    totalDiv.innerHTML = `الإجمالي: $${total.toFixed(2)}`;

    // Remove item functionality
    document.querySelectorAll(".remove-item").forEach(button => {
      button.addEventListener("click", () => {
        const idx = parseInt(button.dataset.index);
        basket.splice(idx, 1);
        localStorage.setItem("basket", JSON.stringify(basket));
        renderBasket();
      });
    });
  }

  // Checkout button functionality
  document.addEventListener("DOMContentLoaded", () => {
    renderBasket();

    document.getElementById("checkout-btn").addEventListener("click", () => {
      const basket = JSON.parse(localStorage.getItem("basket")) || [];
      if (basket.length === 0) {
        alert("السلة فارغة");
        return;
      }

      const name = document.getElementById("customer-name").value.trim();
      const location = document.getElementById("customer-location").value.trim();

      if (!name || !location) {
        alert("الرجاء إدخال الاسم والعنوان");
        return;
      }

      // Build the WhatsApp message
      let message = `طلب من: ${name}\nالموقع: ${location}\n\nتفاصيل الطلب:\n`;
      let total = 0;
      basket.forEach(item => {
        message += `- ${item.title} x${item.qty} : $${(item.price * item.qty).toFixed(2)}\n`;
        total += item.price * item.qty;
      });
      message += `\nالإجمالي: $${total.toFixed(2)}`;

      const encodedMessage = encodeURIComponent(message);

      const whatsappNumber = "960790000"; 
      const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;

      window.open(whatsappURL, "_blank");

      // Clear basket
      localStorage.removeItem("basket");
      renderBasket();
    });
  });
</script>


</body>
</html>
